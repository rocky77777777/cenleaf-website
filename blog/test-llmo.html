<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLMOè¨˜äº‹ãƒ†ã‚¹ãƒˆ | CENLEAF</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .info { background: #f0f8ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
        h1, h2 { color: #333; }
        .content { margin-top: 30px; padding: 20px; background: #fafafa; }
    </style>
</head>
<body>
    <h1>LLMOè¨˜äº‹ãƒ†ã‚¹ãƒˆ</h1>
    
    <div id="status" class="info">
        <p>ğŸ”„ è¨˜äº‹ã‚’å–å¾—ä¸­...</p>
    </div>
    
    <div id="debug" class="info">
        <h3>ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h3>
        <pre id="debug-info">èª­ã¿è¾¼ã¿ä¸­...</pre>
    </div>
    
    <div id="article-content" class="content" style="display: none;">
        <h2 id="article-title"></h2>
        <div id="article-body"></div>
    </div>

    <script>
        // è¨­å®š
        const SERVICE_ID = 'cenleaf';
        const ENDPOINT = 'blogs';
        const API_KEY = 'gfvzXw58nnvw3daLCbWS9z22SMKeIhxa1KWw';
        const TARGET_SLUG = 'llmo-ai-search-optimization';

        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
        function updateDebug(info) {
            document.getElementById('debug-info').textContent = JSON.stringify(info, null, 2);
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `info ${type}`;
            statusDiv.innerHTML = `<p>${message}</p>`;
        }

        // è¨˜äº‹ã‚’è¡¨ç¤º
        function displayArticle(article) {
            document.getElementById('article-title').textContent = article.title;
            document.getElementById('article-body').innerHTML = article.content;
            document.getElementById('article-content').style.display = 'block';
        }

        // è¨˜äº‹å–å¾—ãƒ†ã‚¹ãƒˆ
        async function testFetchArticle() {
            try {
                updateStatus('ğŸ“¡ microCMSã«æ¥ç¶šä¸­...');
                
                // æ–¹æ³•1: å…¨è¨˜äº‹ã‚’å–å¾—ã—ã¦slugã§ãƒ•ã‚£ãƒ«ã‚¿
                const allArticlesUrl = `https://${SERVICE_ID}.microcms.io/api/v1/${ENDPOINT}?limit=100`;
                
                updateDebug({
                    'ãƒ†ã‚¹ãƒˆæ–¹æ³•': 'å…¨è¨˜äº‹å–å¾— â†’ slugã§ãƒ•ã‚£ãƒ«ã‚¿',
                    'URL': allArticlesUrl,
                    'ã‚¿ãƒ¼ã‚²ãƒƒãƒˆslug': TARGET_SLUG
                });

                const response = await fetch(allArticlesUrl, {
                    headers: {
                        'X-MICROCMS-API-KEY': API_KEY
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                updateStatus('âœ… APIæ¥ç¶šæˆåŠŸï¼è¨˜äº‹ã‚’æ¤œç´¢ä¸­...');
                
                updateDebug({
                    'APIæ¥ç¶š': 'æˆåŠŸ',
                    'å–å¾—è¨˜äº‹æ•°': data.contents.length,
                    'å…¨è¨˜äº‹ã®slug': data.contents.map(item => item.slug),
                    'ãƒ•ã‚£ãƒ«ã‚¿çµæœ': data.contents.filter(item => item.slug === TARGET_SLUG).length
                });

                // slugã§è¨˜äº‹ã‚’æ¤œç´¢
                const article = data.contents.find(item => item.slug === TARGET_SLUG);
                
                if (article) {
                    updateStatus('ğŸ‰ è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼', 'success');
                    displayArticle(article);
                    
                    updateDebug({
                        'è¨˜äº‹ç™ºè¦‹': 'æˆåŠŸ',
                        'è¨˜äº‹ID': article.id,
                        'è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«': article.title,
                        'è¨˜äº‹slug': article.slug,
                        'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é•·': article.content.length
                    });
                } else {
                    updateStatus('âŒ æŒ‡å®šã•ã‚ŒãŸslugã®è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                    
                    updateDebug({
                        'è¨˜äº‹ç™ºè¦‹': 'å¤±æ•—',
                        'ã‚¿ãƒ¼ã‚²ãƒƒãƒˆslug': TARGET_SLUG,
                        'åˆ©ç”¨å¯èƒ½ãªslug': data.contents.map(item => item.slug)
                    });
                }

            } catch (error) {
                updateStatus(`âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                
                updateDebug({
                    'ã‚¨ãƒ©ãƒ¼': error.message,
                    'ã‚¹ã‚¿ãƒƒã‚¯': error.stack
                });
            }
        }

        // å®Ÿè¡Œ
        testFetchArticle();
    </script>
</body>
</html>